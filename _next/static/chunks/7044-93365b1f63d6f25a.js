"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7044],{71059:function(e,t,n){var r=n(57437),l=n(2265),s=n(15731),o=n(32859),a=n(61273),i=n(1755),c=n(74272),u=n(53974);let d=e=>{let{content:t,className:n,children:l}=e;return(0,r.jsx)("div",{className:"".concat("prose prose-code:whitespace-pre-wrap prose-code:before:hidden prose-code:after:hidden prose-pre:m-0 prose-pre:max-w-full prose-pre:bg-transparent prose-pre:p-0"," ").concat(n),children:(0,r.jsx)(s.AnimatedMarkdown,{content:("string"==typeof t?t:"string"==typeof l?l:"").replaceAll("\n","  \n"),sep:"word",animation:"fadeIn",animationDuration:"0.5s",animationTimingFunction:"ease-in-out"})})},x=e=>{let{parsed:t}=e;return(0,r.jsx)("pre",{className:"max-w-full whitespace-pre-wrap text-blue-500",children:JSON.stringify(t,null,1)})},p=e=>{let{parsed:t}=e;return(0,r.jsx)(d,{className:"text-lg",content:(null==t?void 0:t.text)||""})},m=e=>{let{parsed:t,onTTSPlay:n,isTTSPlaying:s,isCompact:o}=e,{entries:a}=t,[i,c]=(0,l.useState)(null);return(0,r.jsx)("div",{className:"flex flex-col flex-wrap gap-6",children:null==a?void 0:a.map((e,t)=>(0,r.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[a.length>1&&(0,r.jsxs)("div",{className:"px-2 text-lg font-bold",children:[t+1,"."]}),(0,r.jsxs)("div",{onClick:()=>{var r;let l=(null==e?void 0:null===(r=e.word_or_expression)||void 0===r?void 0:r.trim())||"";RegExp("^\\p{P}+$","u").test(l)||(n(l),c(t))},className:"flex flex-col rounded p-2 transition duration-300 ".concat(i===t&&s?"bg-[#2552F4]/10 text-[#2552F4]":"bg-black/5"),children:[(0,r.jsx)(d,{className:"break-words text-xl font-normal transition duration-300 ".concat(i===t&&s?"text-[#2552F4]":""),children:e.word_or_expression}),(0,r.jsx)(d,{className:"whitespace-normal pt-2 text-sm opacity-50 transition duration-300 ".concat(i===t&&s?"text-[#2552F4]":""),children:e.translation})]})]},t))})},f=e=>{let{parsed:t,onTTSPlay:n,isTTSPlaying:l,isCompact:s}=e;return(0,r.jsxs)("div",{className:"flex flex-col items-center gap-3 text-center",children:[(0,r.jsx)("span",{className:"text-black/50",children:"Quiz:"}),(0,r.jsx)("div",{className:"rounded p-4 transition duration-300 ".concat(l?"bg-[#2552F4]/10":"bg-black/5"),onClick:()=>{n(t.question||"")},children:(0,r.jsx)(d,{content:t.question,className:"text-2xl transition duration-300 ".concat(l?"text-[#2552F4]":"text-black")})})]})},g=e=>{let{parsed:t,onTTSPlay:n,isTTSPlaying:l,isCompact:s}=e;return(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,r.jsxs)("div",{className:"flex flex-row items-center gap-3 rounded border-red-500/50 bg-red-500/10 p-3",children:[(0,r.jsx)(o.J,{icon:a.zu6,className:"flex-none text-xl text-red-500"}),(0,r.jsx)(d,{className:"text-2xl text-red-500",children:null==t?void 0:t.student_said})]}),(0,r.jsxs)("div",{className:"flex flex-row items-center gap-3 rounded border border-green-500/50 bg-green-500/5 p-3",children:[(0,r.jsx)(o.J,{icon:a.ReY,className:"flex-none text-xl text-green-500"}),(0,r.jsx)("div",{className:"border-none",onClick:()=>n((null==t?void 0:t.should_be)||""),children:(0,r.jsx)(d,{className:"text-2xl text-green-500 underline",children:null==t?void 0:t.should_be})})]})]}),(0,r.jsx)("div",{className:"pt-16 text-center italic",children:(0,r.jsx)(d,{className:"text-black/50",content:null==t?void 0:t.brief_explanation})})]})},v=e=>{let{parsed:t,onTTSPlay:n,isTTSPlaying:s,isCompact:x}=e,{startRecording:p,stopRecording:m,playRecording:f,stopPlayback:g,isPracticeRecording:v,isPlayingAudio:h}=(0,i.I)(),j=!1;if(!x){let{latestPronunciationSuccess:e}=(0,c.MV)("WHITEBOARD",{latestPronunciationSuccess:null});j=null==e||e}let b=(0,u.usePrevious)(j);return(0,l.useEffect)(()=>{if(j&&!1==b){let e=new Audio("encouragement.mp3");e.volume=.25,e.play()}},[j]),(0,r.jsxs)("div",{className:"flex h-full w-full flex-col items-center gap-4",children:[(0,r.jsx)("div",{className:"flex-grow"}),(0,r.jsxs)("button",{className:"relative mx-2 rounded px-4 py-2 transition duration-300 ".concat(s?"bg-[#2552F4]/10":"bg-black/5"," ").concat(j?"border border-green-500/50 bg-green-500/5":""),onClick:()=>{n((null==t?void 0:t.word_or_phrase)||"")},children:[(0,r.jsx)(d,{className:"text-2xl transition duration-300 ".concat(s?"text-[#2552F4]":"text-black"," ").concat(j?"text-green-500":""),children:null==t?void 0:t.word_or_phrase}),(0,r.jsx)(a.ETl,{className:"absolute -bottom-2 -right-2 text-xl text-green-500 transition duration-300 ".concat(j?"opacity-100":"scale-0 opacity-0")})]}),(0,r.jsx)("div",{className:"flex-grow"}),(0,r.jsx)("div",{className:"flex w-full shrink flex-col items-center gap-4",children:(0,r.jsxs)("div",{className:"flex w-full justify-evenly",children:[(0,r.jsx)("div",{className:"flex w-16 flex-1 flex-col items-center gap-2",children:(0,r.jsxs)("button",{onClick:()=>{n((null==t?void 0:t.word_or_phrase)||"")},className:"flex items-center gap-2 rounded-full p-4 text-[#2552F4]",children:[(0,r.jsx)(o.J,{className:"text-lg",icon:s?a.JuG:a.KLu}),(0,r.jsx)("div",{className:"font-medium",children:"Example"})]})}),(0,r.jsx)("div",{className:"flex w-16 flex-1 flex-col items-center gap-2",children:(0,r.jsxs)("button",{onClick:()=>h?g():f(),className:"flex items-center gap-2 rounded-full p-4 text-[#2552F4]",children:[(0,r.jsx)(o.J,{className:"text-md text-[#2552F4]",icon:h?a.JuG:a.aYU}),(0,r.jsx)("div",{className:"font-medium",children:"You"})]})})]})})]})};t.ZP=e=>{let{funcCall:t,onTTSPlay:n,isTTSPlaying:l,isCompact:s}=e,o=t.name,a=JSON.parse(t.arguments||"{}");return a&&("new_word_or_expressions"===o?(0,r.jsx)(m,{parsed:a,onTTSPlay:n,isTTSPlaying:l,isCompact:s}):"quiz_question"===o?(0,r.jsx)(f,{parsed:a,onTTSPlay:n,isTTSPlaying:l,isCompact:s}):"mistake_correction"===o?(0,r.jsx)(g,{parsed:a,onTTSPlay:n,isTTSPlaying:l,isCompact:s}):"pronunciation_practice"===o?(0,r.jsx)(v,{parsed:a,onTTSPlay:n,isTTSPlaying:l,isCompact:s}):"write_on_whiteboard"===o?(0,r.jsx)(p,{parsed:a}):(0,r.jsx)(x,{parsed:a}))}},56870:function(e,t,n){n.d(t,{GlobalAudioContextProvider:function(){return o},Y:function(){return a}});var r=n(57437),l=n(2265);let s=(0,l.createContext)(null),o=e=>{let{children:t}=e,n=(0,l.useRef)(null);return n.current||(console.log("creating audio context"),n.current=new AudioContext,n.current.onstatechange=()=>{var e,t,r,l,s,o;if(console.log("onstagechange - AudioContext state changed: ",null===(e=n.current)||void 0===e?void 0:e.state),(null===(t=n.current)||void 0===t?void 0:t.state)==="suspended"&&(console.log("Attempting to resume AudioContext..."),null===(s=n.current)||void 0===s||s.resume().then(()=>{var e;console.log("AudioContext state: ",null===(e=n.current)||void 0===e?void 0:e.state)}).catch(e=>{console.error("Failed to resume AudioContext:",e)})),(null===(r=n.current)||void 0===r?void 0:r.state.toString())==="interrupted"&&console.log("Safari interrupted audiocontext, but won't resume for now..."),(null===(l=n.current)||void 0===l?void 0:l.state)==="running"){let e=null===(o=n.current)||void 0===o?void 0:o.currentTime;setTimeout(()=>{var t;(null===(t=n.current)||void 0===t?void 0:t.currentTime)===e&&console.warn("AudioContext currentTime is stuck, attempting to fix...")},100)}}),(0,r.jsx)(s.Provider,{value:n.current,children:t})},a=()=>{let e=(0,l.useContext)(s);if(!e)throw Error("useAudioContext must be used within a GlobalAudioContextProvider");return e}},1755:function(e,t,n){n.d(t,{I:function(){return l}});var r=n(2265);function l(){let[e,t]=(0,r.useState)(!1),[n,l]=(0,r.useState)(!1),s=(0,r.useRef)(null),o=(0,r.useRef)(null),a=(0,r.useRef)(null),[i,c]=(0,r.useState)(null),u=async()=>{try{let e=await navigator.mediaDevices.getUserMedia({audio:!0});s.current=e,o.current=new MediaRecorder(e);let n=[];o.current.ondataavailable=e=>{e.data.size>0&&n.push(e.data)},o.current.onstop=()=>{let e=new Blob(n,{type:"audio/mpeg"});c(e),t(!1)},o.current.start(),t(!0)}catch(e){console.error("Error accessing microphone:",e)}},d=()=>{o.current&&"recording"===o.current.state&&o.current.stop(),s.current&&s.current.getTracks().forEach(e=>e.stop())},x=()=>{a.current&&(a.current.pause(),a.current.currentTime=0,l(!1))};return(0,r.useEffect)(()=>()=>{d(),x()},[]),{startRecording:u,stopRecording:d,playRecording:()=>{i?(a.current||(a.current=new Audio),a.current.src=URL.createObjectURL(i),a.current.play(),l(!0),a.current.onended=()=>{l(!1)}):console.warn("No recording available to play")},stopPlayback:x,isPracticeRecording:e,isPlayingAudio:n}}}}]);